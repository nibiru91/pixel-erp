[{"name":"/#Supabase Prefab/Supabase Prefab/User/Supabase - Log In","nodes":[{"id":"e9534d7b-1bce-16d5-f580-8e0df1d84d61","type":"Component Inputs","parameters":{},"ports":[],"children":[]},{"id":"7318a93c-d271-d1f4-1799-11e62eeb6c45","type":"Component Outputs","parameters":{},"ports":[],"children":[]},{"id":"3058ca75-86d3-fde8-ec58-7f3c8aebed57","type":"JavaScriptFunction","parameters":{"functionScript":"//console.clear()\n\nif (!Boolean(Noodl.Variables.supabase)){\n    console.error(\"Supabase client not initialized\")\n    return\n}\n\nlet { data, error } = await Noodl.Variables.supabase.auth.signInWithPassword({\n  email: Inputs.email,\n  password: Inputs.password,\n})\n\nif (error) {\n\n  Noodl.Objects.currentUser.loggedIn = false\n\n  switch (error.message) {\n    case \"Invalid login credentials\":\n      Outputs.error = \"401\"\n      break;\n    case \"Email not confirmed\":\n      Outputs.error = \"402\"\n      break;\n    default:\n      Outputs.error = \"400\"\n\n  }\n  console.error(\"[log in] error: \", error)\n  Outputs.Failure()\n\n} else {\n\n  Outputs.data = data\n  Outputs.error = \"200\"\n  Noodl.Objects.currentUser.loggedIn = true\n  Noodl.Objects.currentUser.auth = data.user\n  Noodl.Objects.currentUser.session = data.session\n  //data.session.user.sbid = data.session.user.id\n  //Noodl.Objects.currentUser.setAll(data)\n\n  Outputs.Success()\n\n}"},"ports":[{"name":"in-email","displayName":"email","plug":"input","type":"*","group":"Inputs","index":4},{"name":"in-password","displayName":"password","plug":"input","type":"*","group":"Inputs","index":5},{"name":"out-Failure","displayName":"Failure","plug":"output","type":"signal","group":"Outputs","index":6},{"name":"out-Success","displayName":"Success","plug":"output","type":"signal","group":"Outputs","index":7},{"name":"out-error","displayName":"error","plug":"output","type":"*","group":"Outputs","index":8},{"name":"out-data","displayName":"data","plug":"output","type":"*","group":"Outputs","index":9}],"children":[]},{"id":"413ca631-7d2e-b543-8072-09c9433be1e8","type":"Event Sender","parameters":{"channelName":"Supabase User Logged In"},"ports":[],"children":[]}],"connections":[{"sourceId":"e9534d7b-1bce-16d5-f580-8e0df1d84d61","sourcePort":"Do","targetId":"3058ca75-86d3-fde8-ec58-7f3c8aebed57","targetPort":"run"},{"sourceId":"e9534d7b-1bce-16d5-f580-8e0df1d84d61","sourcePort":"Email","targetId":"3058ca75-86d3-fde8-ec58-7f3c8aebed57","targetPort":"in-email"},{"sourceId":"e9534d7b-1bce-16d5-f580-8e0df1d84d61","sourcePort":"Password","targetId":"3058ca75-86d3-fde8-ec58-7f3c8aebed57","targetPort":"in-password"},{"sourceId":"3058ca75-86d3-fde8-ec58-7f3c8aebed57","sourcePort":"out-Failure","targetId":"7318a93c-d271-d1f4-1799-11e62eeb6c45","targetPort":"Failure"},{"sourceId":"3058ca75-86d3-fde8-ec58-7f3c8aebed57","sourcePort":"out-error","targetId":"7318a93c-d271-d1f4-1799-11e62eeb6c45","targetPort":"Error"},{"sourceId":"3058ca75-86d3-fde8-ec58-7f3c8aebed57","sourcePort":"out-Success","targetId":"7318a93c-d271-d1f4-1799-11e62eeb6c45","targetPort":"Success"},{"sourceId":"3058ca75-86d3-fde8-ec58-7f3c8aebed57","sourcePort":"out-Success","targetId":"413ca631-7d2e-b543-8072-09c9433be1e8","targetPort":"sendEvent"}],"ports":[{"name":"Success","type":"signal","plug":"output","index":0},{"name":"Do","type":{"name":"signal","allowConnectionsOnly":true},"group":"Actions","plug":"input","index":0},{"name":"Failure","type":"signal","plug":"output","index":1},{"name":"Email","type":"*","group":"Inputs","plug":"input","index":1},{"name":"Data","type":"*","plug":"output","index":2},{"name":"Password","type":"*","group":"Inputs","plug":"input","index":2},{"name":"Error","type":"*","plug":"output","index":3}],"roots":[]}]