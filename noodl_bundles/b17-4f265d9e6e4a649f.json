[{"name":"/Home","nodes":[{"id":"73a69caf-3d68-5ae0-ebf3-2c570e65eff5","type":"Page","parameters":{},"ports":[],"children":[{"id":"5a5a50cb-e215-3b13-f06d-f677311cae6c","type":"Group","parameters":{"scrollEnabled":false,"clip":false,"sizeMode":"explicit"},"ports":[],"children":[{"id":"237179e7-9659-fb62-3244-74b479259e6d","type":"/Dashboards/DashMain_incassato","parameters":{},"ports":[],"children":[]}]}]},{"id":"4c57dea7-0ffa-0ca2-d557-e600f57703a3","type":"PageInputs","parameters":{},"ports":[],"children":[]},{"id":"881c6b1b-0a65-2fd1-8f3b-4d025e448f30","type":"JavaScriptFunction","parameters":{"functionScript":"if (!Inputs.Profile) {\n    Outputs.LogOut()\n} else {\n    const isAdmin = Inputs.Profile.is_admin;\n    if (isAdmin) {\n        Outputs.Admin();\n    } else { Outputs.Venditore(); }\n}"},"ports":[{"name":"in-Profile","displayName":"Profile","plug":"input","type":"*","group":"Inputs","index":4},{"name":"out-LogOut","displayName":"LogOut","plug":"output","type":"signal","group":"Outputs","index":5},{"name":"out-Admin","displayName":"Admin","plug":"output","type":"signal","group":"Outputs","index":6},{"name":"out-Venditore","displayName":"Venditore","plug":"output","type":"signal","group":"Outputs","index":7}],"children":[]},{"id":"032c0c2c-b68c-407b-156b-c936b0aa1a0d","type":"RouterNavigate","parameters":{"router":"Supabase Logged In Router","target":"/Venditore"},"ports":[],"children":[]},{"id":"81a790d8-be7f-756b-1eec-9ee881098809","type":"Model2","parameters":{"modelId":"currentUser","properties":"profile"},"ports":[],"children":[]},{"id":"da9e58af-c95d-a2eb-d1be-4b0f138d6da2","type":"RouterNavigate","parameters":{"router":"Supabase Not Logged In Router","target":"/#Supabase Prefab/Supabase Prefab/Pages/Log in"},"ports":[],"children":[]}],"connections":[{"sourceId":"73a69caf-3d68-5ae0-ebf3-2c570e65eff5","sourcePort":"didMount","targetId":"881c6b1b-0a65-2fd1-8f3b-4d025e448f30","targetPort":"run"},{"sourceId":"81a790d8-be7f-756b-1eec-9ee881098809","sourcePort":"prop-profile","targetId":"881c6b1b-0a65-2fd1-8f3b-4d025e448f30","targetPort":"in-Profile"},{"sourceId":"881c6b1b-0a65-2fd1-8f3b-4d025e448f30","sourcePort":"out-Venditore","targetId":"032c0c2c-b68c-407b-156b-c936b0aa1a0d","targetPort":"navigate"},{"sourceId":"881c6b1b-0a65-2fd1-8f3b-4d025e448f30","sourcePort":"out-LogOut","targetId":"da9e58af-c95d-a2eb-d1be-4b0f138d6da2","targetPort":"navigate"}],"ports":[],"roots":["73a69caf-3d68-5ae0-ebf3-2c570e65eff5"]},{"name":"/Dashboards/DashMain_incassato","nodes":[{"id":"01ab2a05-84fd-2c67-3e24-56f9b00cfb08","type":"Group","parameters":{"sizeMode":"explicit","width":{"value":100,"unit":"%"},"height":{"value":100,"unit":"%"}},"ports":[],"children":[{"id":"57e347e9-c546-75cb-363f-ad412f8c3610","type":"Group","parameters":{},"ports":[],"children":[{"id":"00039807-376c-4c37-969f-d330ccd70cd4","type":"Group","parameters":{"marginLeft":{"value":16,"unit":"px"},"marginTop":{"value":16,"unit":"px"},"marginRight":{"value":16,"unit":"px"},"marginBottom":{"value":16,"unit":"px"},"sizeMode":"contentHeight","alignItems":"center"},"ports":[],"children":[{"id":"41fe3b25-720e-0f8f-d094-ce72146eef82","type":"Group","parameters":{},"ports":[],"children":[{"id":"7c70eab4-742b-0d8d-25d8-d249ab1eddfa","type":"Group","parameters":{"flexDirection":"row","sizeMode":"contentHeight"},"ports":[],"children":[{"id":"bbe009be-89f2-0b0d-162b-20b3fb3d3eec","type":"net.noodl.controls.options","parameters":{"items":"[\n    {\"Label\":\"nessun filtro\", \"Value\":\"\"},\n    {\"Label\":\"high-ticket\", \"Value\":\"1\"},\n    {\"Label\":\"mid-ticket\", \"Value\":\"2\"},\n    {\"Label\":\"low-ticket\", \"Value\":\"3\"}\n]","label":"Ramo B.U.","marginBottom":{"value":16,"unit":"px"},"marginRight":{"value":16,"unit":"px"}},"ports":[],"children":[]},{"id":"9270014c-c8e9-fd75-9902-69f84e7c8710","type":"net.noodl.controls.options","parameters":{"items":"[\n    {\"Label\":\"nessun filtro\", \"Value\":\"\"},\n    {\"Label\":\"online\", \"Value\":\"1\"},\n    {\"Label\":\"diretta\", \"Value\":\"2\"}\n]","label":"Business Unit","marginBottom":{"value":16,"unit":"px"}},"ports":[],"children":[]}]},{"id":"4161376b-95e8-a64a-8498-b76581765e28","type":"net.noodl.controls.options","parameters":{"label":"Soggetto","marginBottom":{"value":16,"unit":"px"},"items":"[]"},"ports":[],"children":[]},{"id":"6f307066-14c6-6691-8c38-1a34bd7298ce","type":"net.noodl.controls.options","parameters":{"label":"Gestore / Fornitore","marginBottom":{"value":16,"unit":"px"},"items":"[]"},"ports":[],"children":[]},{"id":"f8b0631a-53bc-7230-a74e-62b239cdff97","type":"Group","parameters":{"flexDirection":"row","marginRight":{"value":16,"unit":"px"},"sizeMode":"contentHeight"},"ports":[],"children":[{"id":"62d2a5ec-1af4-744b-c65f-3b18c3b95cfa","type":"/Components/Date Picker","parameters":{"Show Label":true,"Label":"Data DAL","Margin Bottom":{"value":16,"unit":"px"},"Margin Right":{"value":16,"unit":"px"}},"ports":[],"children":[]},{"id":"feb77d65-5790-c466-e237-f5f767efdc66","type":"/Components/Date Picker","parameters":{"Show Label":true,"Label":"Data AL","Margin Bottom":{"value":16,"unit":"px"}},"ports":[],"children":[]}]}]},{"id":"6b43adb8-0386-03da-1a88-89edb319b322","type":"Group","parameters":{"sizeMode":"explicit","height":{"value":500,"unit":"px"},"alignItems":"center"},"ports":[],"children":[{"id":"860f3e2c-0824-656e-bc4f-196b03b35686","type":"net.noodl.controls.checkbox","parameters":{"label":"Grafici Giornalieri"},"ports":[],"children":[]},{"id":"96766584-a038-ed8d-b113-1156121e7080","type":"Line Chart","parameters":{},"ports":[],"children":[]},{"id":"8332971b-b99a-ea0c-51de-e2a24d134a2a","type":"Bar Chart","parameters":{},"ports":[],"children":[]}]},{"id":"1a2ddaae-3c5e-d498-6ad9-8d5e307b94a7","type":"Group","parameters":{"paddingTop":{"value":0,"unit":"px"},"marginTop":{"value":70,"unit":"px"},"marginBottom":{"value":50,"unit":"px"},"alignItems":"center","sizeMode":"explicit"},"ports":[],"children":[{"id":"d3ee77dd-19ce-ac66-a410-d4eded40f1a7","type":"net.noodl.visual.columns","parameters":{"layoutString":"1 1","justifyContent":"center"},"ports":[],"children":[{"id":"476c18c0-7b98-c35e-711d-b6c998cc5995","type":"Group","parameters":{"paddingLeft":{"value":5,"unit":"px"},"paddingTop":{"value":5,"unit":"px"},"paddingRight":{"value":5,"unit":"px"},"paddingBottom":{"value":5,"unit":"px"},"borderStyle":"solid","borderColor":"Grey - 400","borderWidth":{"value":1,"unit":"px"},"borderRadius":{"value":4,"unit":"px"},"alignItems":"center","alignX":"center","alignY":"center"},"ports":[],"children":[{"id":"311a8a16-5fd8-9e1c-759e-4e84bd4a5dea","type":"Text","parameters":{"textStyle":"Title Large","color":"green","textAlignX":"center","fontFamily":"fonts/Roboto/Roboto-Light.ttf"},"ports":[],"children":[]},{"id":"5a46de0c-2b23-2580-75ce-6236159cf209","type":"Text","parameters":{"textStyle":"Title Large","color":"green","textAlignX":"center","fontFamily":"fonts/Roboto/Roboto-Black.ttf","fontSize":{"value":30,"unit":"px"}},"ports":[],"children":[]}]},{"id":"5306aa9f-1068-2485-a9dc-6c6fa5d66f2d","type":"Group","parameters":{"paddingLeft":{"value":5,"unit":"px"},"paddingTop":{"value":5,"unit":"px"},"paddingRight":{"value":5,"unit":"px"},"paddingBottom":{"value":5,"unit":"px"},"borderStyle":"solid","borderWidth":{"value":1,"unit":"px"},"borderColor":"Grey - 400","borderRadius":{"value":4,"unit":"px"}},"ports":[],"children":[{"id":"cd50dfc7-76ea-b822-0072-e663fc1a66ca","type":"Text","parameters":{"textStyle":"Title Large","color":"green","textAlignX":"center","fontFamily":"fonts/Roboto/Roboto-Light.ttf"},"ports":[],"children":[]},{"id":"7b1432f0-2c74-7b02-66f9-f85162e36fe2","type":"Text","parameters":{"textStyle":"Title Large","color":"green","textAlignX":"center","fontFamily":"fonts/Roboto/Roboto-Black.ttf","fontSize":{"value":30,"unit":"px"}},"ports":[],"children":[]}]}]}]},{"id":"92e8a0b1-c8d1-fb2b-a2e4-c1cec67b0d1f","type":"net.noodl.visual.columns","parameters":{"layoutString":"1 1"},"ports":[],"children":[{"id":"98b38b6a-1223-9d90-f7a1-76252a508b24","type":"Group","parameters":{},"ports":[],"children":[{"id":"bd42773b-a620-958e-8eda-bb22162ebdd1","type":"Text","parameters":{"text":"","textStyle":"Title Large","color":"blue","marginLeft":{"value":16,"unit":"px"},"marginBottom":{"value":16,"unit":"px"},"marginTop":{"value":16,"unit":"px"},"marginRight":{"value":16,"unit":"px"},"fontFamily":"fonts/Roboto/Roboto-Light.ttf","textAlignX":"center"},"ports":[],"children":[]},{"id":"271c0797-c102-fe01-7285-d6dc67e33703","type":"For Each","parameters":{"template":"/Cards/Card_Ricavi","inputMappingScript":"// Here you add mappings between the properties of the item objects and the inputs of the components.\n// 'myComponentInput': 'myObjectProperty',\n// 'anotherComponentInput': function () { return object.get('someProperty') + ' ' + object.get('otherProp') }\n// These are the default mappings based on the selected template component.\nmap({\n\t'supid':'supid',\n\t'date': 'date',\n\t'importo': 'importo',\n\t'soggetto': 'soggetto_ragsoc',\n\t'area': 'an_area_nome',\n\t'ticket': 'an_tecnologia_nome',\n\t'gestore': 'an_gestore_ragsoc',\n\t'prodotto': 'prodotto_nome',\n})"},"ports":[],"children":[]}]},{"id":"60d9903e-c6be-c84f-aa55-2d4c4c141590","type":"Group","parameters":{"sizeMode":"explicit","width":{"value":100,"unit":"%"},"height":{"value":100,"unit":"%"}},"ports":[],"children":[{"id":"3dd90edf-0cde-889d-808e-f77eb29ee4c4","type":"Text","parameters":{"text":"","textStyle":"Title Large","color":"red","marginLeft":{"value":16,"unit":"px"},"marginBottom":{"value":16,"unit":"px"},"marginTop":{"value":16,"unit":"px"},"marginRight":{"value":16,"unit":"px"},"fontFamily":"fonts/Roboto/Roboto-Light.ttf","textAlignX":"center"},"ports":[],"children":[]},{"id":"d6eb206e-c3b0-69dd-c3d1-a59aa7650d09","type":"For Each","parameters":{"templateType":"explicit","template":"/Cards/Card_Costi","items":"[]","inputMappingScript":"// Here you add mappings between the properties of the item objects and the inputs of the components.\n// 'myComponentInput': 'myObjectProperty',\n// 'anotherComponentInput': function () { return object.get('someProperty') + ' ' + object.get('otherProp') }\n// These are the default mappings based on the selected template component.\nmap({\n\t'supid':'supid',\n\t'date': 'date',\n\t'importo': 'importo',\n\t'soggetto_ragsoc': 'soggetto_ragsoc',\n\t'an_area_nome': 'an_area_nome',\n\t'an_tecnologia_nome': 'an_tecnologia_nome',\n\t'descrizione': 'descrizione',\n})\n"},"ports":[],"children":[]}]}]}]}]}]},{"id":"84849c05-db2b-5541-5090-648bd707b578","type":"/Query/Select/Select_ricavi_detail_incassato","parameters":{},"ports":[],"children":[]},{"id":"93af8c99-a371-627c-1882-46b448d775c4","type":"Expression","parameters":{"expression":"\"Totale Ricavi Euro \" + importo.toFixed(2)"},"ports":[],"children":[]},{"id":"05a4bea6-7e29-94ae-2a8a-c14930f97776","type":"Expression","parameters":{"expression":"\"Totale Costi Euro \" + importo.toFixed(2)"},"ports":[],"children":[]},{"id":"bcc916d7-1ddc-30e7-2e49-15754cfe0069","type":"/Query/Select/Select_costi_detail_incassato","parameters":{},"ports":[],"children":[]},{"id":"b4aa6479-2595-d0fe-3ba9-a04a304c8b61","type":"JavaScriptFunction","parameters":{"functionScript":"const supabase = Noodl.Variables.supabase;\n\nif (!supabase) throw new Error('Supabase client not found');\n\n\n\ntry {\n  \n  const { data, error } = await supabase\n        .from('soggetti')\n        .select('id, ragione_sociale')\n        .eq('tipo', 1);\n\n    if (error) {\n    console.error(error)\n    Outputs.Failure();\n    }\n    \n    else {\n    // Trasforma i risultati in un formato { Label, Value }\n    const transformedData = data.map(soggetto => ({\n        Value: soggetto.id.toString(),\n        Label: soggetto.ragione_sociale\n    }));\n\n    //return transformedData;\n\n    Outputs.Data = data;\n    Outputs.TransformedData = transformedData;\n    Outputs.Success();\n\n  }\n} \n  catch (error) {\n    console.error(error)\n    Outputs.Failure();\n  }"},"ports":[{"name":"out-Failure","displayName":"Failure","plug":"output","type":"signal","group":"Outputs","index":4},{"name":"out-Success","displayName":"Success","plug":"output","type":"signal","group":"Outputs","index":5},{"name":"out-Data","displayName":"Data","plug":"output","type":"*","group":"Outputs","index":6},{"name":"out-TransformedData","displayName":"TransformedData","plug":"output","type":"*","group":"Outputs","index":7}],"children":[]},{"id":"12f538e9-6715-b847-132a-ec318273ff63","type":"JavaScriptFunction","parameters":{"functionScript":"const supabase = Noodl.Variables.supabase;\n\nif (!supabase) throw new Error('Supabase client not found');\n\n\n\ntry {\n  \n  const { data, error } = await supabase\n        .from('soggetti')\n        .select('id, ragione_sociale')\n        .eq('tipo', 2,)\n        .eq('is_venditore', true);\n\n    if (error) {\n    console.error(error)\n    Outputs.Failure();\n    }\n    \n    else {\n    // Trasforma i risultati in un formato { Label, Value }\n    const transformedData = data.map(soggetto => ({\n        Value: soggetto.id.toString(),\n        Label: soggetto.ragione_sociale\n    }));\n\n    //return transformedData;\n\n    Outputs.Data = data;\n    Outputs.TransformedData = transformedData;\n    Outputs.Success();\n\n  }\n} \n  catch (error) {\n    console.error(error)\n    Outputs.Failure();\n  }"},"ports":[{"name":"out-Failure","displayName":"Failure","plug":"output","type":"signal","group":"Outputs","index":4},{"name":"out-Success","displayName":"Success","plug":"output","type":"signal","group":"Outputs","index":5},{"name":"out-Data","displayName":"Data","plug":"output","type":"*","group":"Outputs","index":6},{"name":"out-TransformedData","displayName":"TransformedData","plug":"output","type":"*","group":"Outputs","index":7}],"children":[]},{"id":"55ba86d8-53c8-0aac-d7b3-ea5c384f483a","type":"JavaScriptFunction","parameters":{"functionScript":"const supabase = Noodl.Variables.supabase;\n\nif (!supabase) throw new Error('Supabase client not found');\n\n\n\ntry {\n  \n  const { data, error } = await supabase\n        .from('def_an_tecnologia')\n        .select('id, nome');\n\n    if (error) {\n    console.error(error)\n    Outputs.Failure();\n    }\n    \n    else {\n    // Trasforma i risultati in un formato { Label, Value }\n    const transformedData = data.map(tecnologia => ({\n        Value: tecnologia.id.toString(),\n        Label: tecnologia.nome\n    }));\n\n    //return transformedData;\n\n    Outputs.Data = data;\n    Outputs.TransformedData = transformedData;\n    Outputs.Success();\n\n  }\n} \n  catch (error) {\n    console.error(error)\n    Outputs.Failure();\n  }"},"ports":[{"name":"out-Failure","displayName":"Failure","plug":"output","type":"signal","group":"Outputs","index":4},{"name":"out-Success","displayName":"Success","plug":"output","type":"signal","group":"Outputs","index":5},{"name":"out-Data","displayName":"Data","plug":"output","type":"*","group":"Outputs","index":6},{"name":"out-TransformedData","displayName":"TransformedData","plug":"output","type":"*","group":"Outputs","index":7}],"children":[]},{"id":"e3ca5b93-7491-2e19-774f-30d51e62026c","type":"JavaScriptFunction","parameters":{"functionScript":"const supabase = Noodl.Variables.supabase;\n\nif (!supabase) throw new Error('Supabase client not found');\n\n\n\ntry {\n  \n  const { data, error } = await supabase\n        .from('def_an_area')\n        .select('id, nome');\n\n    if (error) {\n    console.error(error)\n    Outputs.Failure();\n    }\n    \n    else {\n    // Trasforma i risultati in un formato { Label, Value }\n    const transformedData = data.map(area => ({\n        Value: area.id.toString(),\n        Label: area.nome\n    }));\n\n    //return transformedData;\n\n    Outputs.Data = data;\n    Outputs.TransformedData = transformedData;\n    Outputs.Success();\n\n  }\n} \n  catch (error) {\n    console.error(error)\n    Outputs.Failure();\n  }"},"ports":[{"name":"out-Failure","displayName":"Failure","plug":"output","type":"signal","group":"Outputs","index":4},{"name":"out-Success","displayName":"Success","plug":"output","type":"signal","group":"Outputs","index":5},{"name":"out-Data","displayName":"Data","plug":"output","type":"*","group":"Outputs","index":6},{"name":"out-TransformedData","displayName":"TransformedData","plug":"output","type":"*","group":"Outputs","index":7}],"children":[]},{"id":"658c2beb-11c6-55c0-ed1f-7c7a5578eedd","type":"Component Inputs","parameters":{},"ports":[],"children":[]},{"id":"1cf19d37-76a2-2937-2c17-6cbab030b4fa","type":"JavaScriptFunction","parameters":{"functionScript":"ricavi = Inputs.ricavi;\n  // Inserisci qui l'array completo \"ricavi\" come nel tuo esempio\n\ncosti = Inputs.costi;\n\n// Mappiamo i costi convertendo gli importi in negativo\nlet costiModificati = costi.map(item => {\n    return {\n        data: item.date,\n        importo: item.importo * -1,  // Moltiplica l'importo per -1, è un costo\n    };\n});\n\n// Mappiamo i ricavi per diminuire le dimensioni del dataset ai soli dati utili, che sono già filtrati\nlet ricaviModificati = ricavi.map(item => {\n    return {\n        data: item.date,\n        importo: item.importo,\n    };\n});\n\n// Uniamo gli array ricavi e costi modificati\nlet risultatoFinale = ricaviModificati.concat(costiModificati);\n\nOutputs.costi = costi;\nOutputs.ricavi = ricavi;\nOutputs.costiRicavi = risultatoFinale;\nOutputs.Success();\n\n"},"ports":[{"name":"in-ricavi","displayName":"ricavi","plug":"input","type":"*","group":"Inputs","index":4},{"name":"in-costi","displayName":"costi","plug":"input","type":"*","group":"Inputs","index":5},{"name":"out-Success","displayName":"Success","plug":"output","type":"signal","group":"Outputs","index":6},{"name":"out-costi","displayName":"costi","plug":"output","type":"*","group":"Outputs","index":7},{"name":"out-ricavi","displayName":"ricavi","plug":"output","type":"*","group":"Outputs","index":8},{"name":"out-costiRicavi","displayName":"costiRicavi","plug":"output","type":"*","group":"Outputs","index":9}],"children":[]},{"id":"ad66c586-469a-0590-18a7-cd9238f7ff24","type":"JavaScriptFunction","parameters":{"functionScript":"// Recupera i dati dagli input\nconst costiRicavi = Inputs.CostiRicavi;\nconst isGiornaliero = Inputs.IsGiornaliero;\n\n// Funzione per estrarre il mese e l'anno dalla data\nconst getMonthYear = date => {\n    const d = new Date(date);\n    return `${d.getMonth() + 1}-${d.getFullYear()}`;\n};\n\n// Funzione per estrarre il giorno, mese e l'anno dalla data\nconst getDayMonthYear = date => {\n    const d = new Date(date);\n    return `${d.getDate()}-${d.getMonth() + 1}-${d.getFullYear()}`;\n};\n\n// Seleziona la funzione corretta in base al tipo di raggruppamento\nconst getKey = isGiornaliero ? getDayMonthYear : getMonthYear;\n\n// Raggruppa e somma gli importi per tipo e calcola la somma totale per periodo\nconst groupedData = costiRicavi.reduce((acc, item) => {\n    const period = getKey(item.data);\n    const tipo = item.importo > 0 ? 1 : 2;\n    const keyTipo = `${period}-${tipo}`;\n    const keyTotal = `${period}-total`;\n\n    // Crea un oggetto per tipo se non esiste\n    if (!acc[keyTipo]) {\n        acc[keyTipo] = {\n            tipo,\n            periodo: period,\n            importo: 0\n        };\n    }\n    // Crea un oggetto per il totale se non esiste\n    if (!acc[keyTotal]) {\n        acc[keyTotal] = {\n            tipo: 'total',\n            periodo: period,\n            importo: 0\n        };\n    }\n    // Aggiorna gli importi\n    acc[keyTipo].importo += item.importo;\n    acc[keyTotal].importo += item.importo;\n\n    return acc;\n}, {});\n\n// Trasforma l'oggetto in array\nconst dataArray = Object.values(groupedData);\n\n// Ottieni un array di periodi unici e ordina cronologicamente\nconst parseDate = period => {\n    const [day, month, year] = period.split('-').map(Number);\n    return new Date(year, month - 1, day || 1);  // `day` può essere `undefined` per il raggruppamento mensile\n};\n\nconst periods = [...new Set(dataArray.map(data => data.periodo))]\n    .sort((a, b) => parseDate(a) - parseDate(b));\n\nconst finalData = periods.reduce((acc, period) => {\n    const tipo1 = dataArray.find(d => d.periodo === period && d.tipo === 1) || { importo: 0, tipo: 1, periodo: period };\n    const tipo2 = dataArray.find(d => d.periodo === period && d.tipo === 2) || { importo: 0, tipo: 2, periodo: period };\n    const total = dataArray.find(d => d.periodo === period && d.tipo === 'total') || { importo: 0, tipo: 'total', periodo: period };\n\n    acc.push(tipo1, tipo2, total);\n    return acc;\n}, []);\n\n// Prepara l'oggetto per Chart.js\nconst labels = periods; // Usa solo il valore del periodo senza prefissi\nconst dataTipo1 = [];\nconst dataTipo2 = [];\nconst dataTotal = [];\n\nfinalData.forEach(item => {\n    if (item.tipo === 1) {\n        dataTipo1.push(item.importo);\n    } else if (item.tipo === 2) {\n        dataTipo2.push(item.importo * -1);  // Moltiplica per -1 per mostrare i costi\n    } else if (item.tipo === 'total') {\n        dataTotal.push(item.importo);  // Totale combinato di ricavi e costi\n    }\n});\n\nconst chartData = {\n    labels,\n    datasets: [\n        {\n            label: 'Ricavi',\n            data: dataTipo1,\n            borderColor: 'blue',\n            backgroundColor: 'blue',\n        },\n        {\n            label: 'Costi',\n            data: dataTipo2,\n            borderColor: 'red',\n            backgroundColor: 'red',\n        },\n        {\n            label: 'Risultato',\n            data: dataTotal,\n            borderColor: 'green',\n            backgroundColor: 'green',\n        }\n    ]\n};\n\nOutputs.Data = chartData;\n\n// Funzione per sommare i valori dataTotal per ottenere un ROL totale\nconst rolTotale = parseFloat((dataTotal.reduce((acc, numero) => acc + numero, 0))).toFixed(2);\n\nOutputs.ROLMensile = dataTotal;\nOutputs.ROLTotale = rolTotale;\n\nconst fatturatoTotale = parseFloat((dataTipo1.reduce((acc, numero) => acc + numero, 0))).toFixed(2);\n\nOutputs.FatturatoTotale = fatturatoTotale;\n\nconst config = {\n    y: {\n        grid: {\n            zeroLineWidth: 3,\n            zeroLineColor: 'rgba(0, 0, 0, 1)',\n            drawBorder: true,\n            color: function (context) {\n                if (context.tick.value === 0) {\n                    return 'rgba(0, 0, 0, 1)';  // Colore per la linea dello zero\n                }\n                return 'rgba(0, 0, 0, 0.1)';  // Colore per le altre linee della griglia\n            }\n        }\n    }\n};\n\nOutputs.YAxis = config;\n"},"ports":[{"name":"in-CostiRicavi","displayName":"CostiRicavi","plug":"input","type":"*","group":"Inputs","index":4},{"name":"in-IsGiornaliero","displayName":"IsGiornaliero","plug":"input","type":"*","group":"Inputs","index":5},{"name":"out-Data","displayName":"Data","plug":"output","type":"*","group":"Outputs","index":6},{"name":"out-ROLMensile","displayName":"ROLMensile","plug":"output","type":"*","group":"Outputs","index":7},{"name":"out-ROLTotale","displayName":"ROLTotale","plug":"output","type":"*","group":"Outputs","index":8},{"name":"out-FatturatoTotale","displayName":"FatturatoTotale","plug":"output","type":"*","group":"Outputs","index":9},{"name":"out-YAxis","displayName":"YAxis","plug":"output","type":"*","group":"Outputs","index":10}],"children":[]},{"id":"a4965311-f3be-dbc0-346c-d2fb1daef4a0","type":"Collection2","parameters":{"collectionId":"ArrayRicavi"},"ports":[],"children":[]},{"id":"84861645-a266-3699-98b2-f421af5597ed","type":"Collection2","parameters":{"collectionId":"ArrayCosti"},"ports":[],"children":[]},{"id":"65637ec6-4457-67b5-5391-64ce6835f55b","type":"Expression","parameters":{"expression":"\"Margine Lordo Periodo Euro \" + (importo * 1).toFixed(2)"},"ports":[],"children":[]},{"id":"584c512b-9f60-90ba-1d01-11d4fcfcc70b","type":"Expression","parameters":{"expression":"\"Margine Netto Periodo Euro \" + ((rol - ((fatturato *0.40) * 0.15))).toFixed(2)"},"ports":[],"children":[]},{"id":"da639c04-8231-64ae-f68f-caf287c7b0dd","type":"Expression","parameters":{"expression":"((margineLordo / incassatoFatturato) * 100).toFixed(2) + \" %\""},"ports":[],"children":[]},{"id":"ccec207b-dedd-cc82-6461-d1293e4e2244","type":"Expression","parameters":{"expression":"((((rol - ((fatturato *0.40) * 0.15))) / fatturato) * 100).toFixed(2) + \" %\""},"ports":[],"children":[]}],"connections":[{"sourceId":"84849c05-db2b-5541-5090-648bd707b578","sourcePort":"totale","targetId":"93af8c99-a371-627c-1882-46b448d775c4","targetPort":"importo"},{"sourceId":"93af8c99-a371-627c-1882-46b448d775c4","sourcePort":"result","targetId":"bd42773b-a620-958e-8eda-bb22162ebdd1","targetPort":"text"},{"sourceId":"84849c05-db2b-5541-5090-648bd707b578","sourcePort":"data","targetId":"271c0797-c102-fe01-7285-d6dc67e33703","targetPort":"items"},{"sourceId":"05a4bea6-7e29-94ae-2a8a-c14930f97776","sourcePort":"result","targetId":"3dd90edf-0cde-889d-808e-f77eb29ee4c4","targetPort":"text"},{"sourceId":"bcc916d7-1ddc-30e7-2e49-15754cfe0069","sourcePort":"totaleCosti","targetId":"05a4bea6-7e29-94ae-2a8a-c14930f97776","targetPort":"importo"},{"sourceId":"bcc916d7-1ddc-30e7-2e49-15754cfe0069","sourcePort":"dataCosti","targetId":"d6eb206e-c3b0-69dd-c3d1-a59aa7650d09","targetPort":"items"},{"sourceId":"b4aa6479-2595-d0fe-3ba9-a04a304c8b61","sourcePort":"out-TransformedData","targetId":"4161376b-95e8-a64a-8498-b76581765e28","targetPort":"items"},{"sourceId":"12f538e9-6715-b847-132a-ec318273ff63","sourcePort":"out-TransformedData","targetId":"6f307066-14c6-6691-8c38-1a34bd7298ce","targetPort":"items"},{"sourceId":"55ba86d8-53c8-0aac-d7b3-ea5c384f483a","sourcePort":"out-TransformedData","targetId":"bbe009be-89f2-0b0d-162b-20b3fb3d3eec","targetPort":"items"},{"sourceId":"e3ca5b93-7491-2e19-774f-30d51e62026c","sourcePort":"out-TransformedData","targetId":"9270014c-c8e9-fd75-9902-69f84e7c8710","targetPort":"items"},{"sourceId":"4161376b-95e8-a64a-8498-b76581765e28","sourcePort":"value","targetId":"84849c05-db2b-5541-5090-648bd707b578","targetPort":"var_when_soggetto"},{"sourceId":"4161376b-95e8-a64a-8498-b76581765e28","sourcePort":"onChange","targetId":"84849c05-db2b-5541-5090-648bd707b578","targetPort":"Run"},{"sourceId":"6f307066-14c6-6691-8c38-1a34bd7298ce","sourcePort":"onChange","targetId":"84849c05-db2b-5541-5090-648bd707b578","targetPort":"Run"},{"sourceId":"6f307066-14c6-6691-8c38-1a34bd7298ce","sourcePort":"value","targetId":"84849c05-db2b-5541-5090-648bd707b578","targetPort":"var_when_gestore"},{"sourceId":"6f307066-14c6-6691-8c38-1a34bd7298ce","sourcePort":"onChange","targetId":"bcc916d7-1ddc-30e7-2e49-15754cfe0069","targetPort":"Run"},{"sourceId":"6f307066-14c6-6691-8c38-1a34bd7298ce","sourcePort":"value","targetId":"bcc916d7-1ddc-30e7-2e49-15754cfe0069","targetPort":"var_when_soggetto"},{"sourceId":"62d2a5ec-1af4-744b-c65f-3b18c3b95cfa","sourcePort":"Changed","targetId":"84849c05-db2b-5541-5090-648bd707b578","targetPort":"Run"},{"sourceId":"62d2a5ec-1af4-744b-c65f-3b18c3b95cfa","sourcePort":"Value","targetId":"84849c05-db2b-5541-5090-648bd707b578","targetPort":"dataDal"},{"sourceId":"62d2a5ec-1af4-744b-c65f-3b18c3b95cfa","sourcePort":"Value","targetId":"bcc916d7-1ddc-30e7-2e49-15754cfe0069","targetPort":"dataDal"},{"sourceId":"62d2a5ec-1af4-744b-c65f-3b18c3b95cfa","sourcePort":"Changed","targetId":"bcc916d7-1ddc-30e7-2e49-15754cfe0069","targetPort":"Run"},{"sourceId":"feb77d65-5790-c466-e237-f5f767efdc66","sourcePort":"Changed","targetId":"84849c05-db2b-5541-5090-648bd707b578","targetPort":"Run"},{"sourceId":"feb77d65-5790-c466-e237-f5f767efdc66","sourcePort":"Value","targetId":"84849c05-db2b-5541-5090-648bd707b578","targetPort":"dataAl"},{"sourceId":"feb77d65-5790-c466-e237-f5f767efdc66","sourcePort":"Changed","targetId":"bcc916d7-1ddc-30e7-2e49-15754cfe0069","targetPort":"Run"},{"sourceId":"feb77d65-5790-c466-e237-f5f767efdc66","sourcePort":"Value","targetId":"bcc916d7-1ddc-30e7-2e49-15754cfe0069","targetPort":"dataAl"},{"sourceId":"bbe009be-89f2-0b0d-162b-20b3fb3d3eec","sourcePort":"onChange","targetId":"84849c05-db2b-5541-5090-648bd707b578","targetPort":"Run"},{"sourceId":"bbe009be-89f2-0b0d-162b-20b3fb3d3eec","sourcePort":"value","targetId":"84849c05-db2b-5541-5090-648bd707b578","targetPort":"var_when_ticket"},{"sourceId":"bbe009be-89f2-0b0d-162b-20b3fb3d3eec","sourcePort":"onChange","targetId":"bcc916d7-1ddc-30e7-2e49-15754cfe0069","targetPort":"Run"},{"sourceId":"bbe009be-89f2-0b0d-162b-20b3fb3d3eec","sourcePort":"value","targetId":"bcc916d7-1ddc-30e7-2e49-15754cfe0069","targetPort":"var_when_ticket"},{"sourceId":"9270014c-c8e9-fd75-9902-69f84e7c8710","sourcePort":"onChange","targetId":"84849c05-db2b-5541-5090-648bd707b578","targetPort":"Run"},{"sourceId":"9270014c-c8e9-fd75-9902-69f84e7c8710","sourcePort":"value","targetId":"84849c05-db2b-5541-5090-648bd707b578","targetPort":"var_when_area"},{"sourceId":"9270014c-c8e9-fd75-9902-69f84e7c8710","sourcePort":"onChange","targetId":"bcc916d7-1ddc-30e7-2e49-15754cfe0069","targetPort":"Run"},{"sourceId":"9270014c-c8e9-fd75-9902-69f84e7c8710","sourcePort":"value","targetId":"bcc916d7-1ddc-30e7-2e49-15754cfe0069","targetPort":"var_when_area"},{"sourceId":"658c2beb-11c6-55c0-ed1f-7c7a5578eedd","sourcePort":"Run","targetId":"84849c05-db2b-5541-5090-648bd707b578","targetPort":"Run"},{"sourceId":"658c2beb-11c6-55c0-ed1f-7c7a5578eedd","sourcePort":"Run","targetId":"bcc916d7-1ddc-30e7-2e49-15754cfe0069","targetPort":"Run"},{"sourceId":"1cf19d37-76a2-2937-2c17-6cbab030b4fa","sourcePort":"out-Success","targetId":"ad66c586-469a-0590-18a7-cd9238f7ff24","targetPort":"run"},{"sourceId":"1cf19d37-76a2-2937-2c17-6cbab030b4fa","sourcePort":"out-costiRicavi","targetId":"ad66c586-469a-0590-18a7-cd9238f7ff24","targetPort":"in-CostiRicavi"},{"sourceId":"ad66c586-469a-0590-18a7-cd9238f7ff24","sourcePort":"out-Data","targetId":"96766584-a038-ed8d-b113-1156121e7080","targetPort":"data"},{"sourceId":"84849c05-db2b-5541-5090-648bd707b578","sourcePort":"data","targetId":"a4965311-f3be-dbc0-346c-d2fb1daef4a0","targetPort":"items"},{"sourceId":"bcc916d7-1ddc-30e7-2e49-15754cfe0069","sourcePort":"dataCosti","targetId":"84861645-a266-3699-98b2-f421af5597ed","targetPort":"items"},{"sourceId":"a4965311-f3be-dbc0-346c-d2fb1daef4a0","sourcePort":"items","targetId":"1cf19d37-76a2-2937-2c17-6cbab030b4fa","targetPort":"in-ricavi"},{"sourceId":"84861645-a266-3699-98b2-f421af5597ed","sourcePort":"items","targetId":"1cf19d37-76a2-2937-2c17-6cbab030b4fa","targetPort":"in-costi"},{"sourceId":"a4965311-f3be-dbc0-346c-d2fb1daef4a0","sourcePort":"changed","targetId":"1cf19d37-76a2-2937-2c17-6cbab030b4fa","targetPort":"run"},{"sourceId":"84861645-a266-3699-98b2-f421af5597ed","sourcePort":"changed","targetId":"1cf19d37-76a2-2937-2c17-6cbab030b4fa","targetPort":"run"},{"sourceId":"ad66c586-469a-0590-18a7-cd9238f7ff24","sourcePort":"out-Data","targetId":"8332971b-b99a-ea0c-51de-e2a24d134a2a","targetPort":"data"},{"sourceId":"ad66c586-469a-0590-18a7-cd9238f7ff24","sourcePort":"out-YAxis","targetId":"96766584-a038-ed8d-b113-1156121e7080","targetPort":"scales"},{"sourceId":"ad66c586-469a-0590-18a7-cd9238f7ff24","sourcePort":"out-YAxis","targetId":"8332971b-b99a-ea0c-51de-e2a24d134a2a","targetPort":"scales"},{"sourceId":"ad66c586-469a-0590-18a7-cd9238f7ff24","sourcePort":"out-ROLTotale","targetId":"65637ec6-4457-67b5-5391-64ce6835f55b","targetPort":"importo"},{"sourceId":"65637ec6-4457-67b5-5391-64ce6835f55b","sourcePort":"result","targetId":"311a8a16-5fd8-9e1c-759e-4e84bd4a5dea","targetPort":"text"},{"sourceId":"584c512b-9f60-90ba-1d01-11d4fcfcc70b","sourcePort":"result","targetId":"cd50dfc7-76ea-b822-0072-e663fc1a66ca","targetPort":"text"},{"sourceId":"ad66c586-469a-0590-18a7-cd9238f7ff24","sourcePort":"out-FatturatoTotale","targetId":"584c512b-9f60-90ba-1d01-11d4fcfcc70b","targetPort":"fatturato"},{"sourceId":"ad66c586-469a-0590-18a7-cd9238f7ff24","sourcePort":"out-ROLTotale","targetId":"584c512b-9f60-90ba-1d01-11d4fcfcc70b","targetPort":"rol"},{"sourceId":"ad66c586-469a-0590-18a7-cd9238f7ff24","sourcePort":"out-FatturatoTotale","targetId":"da639c04-8231-64ae-f68f-caf287c7b0dd","targetPort":"incassatoFatturato"},{"sourceId":"ad66c586-469a-0590-18a7-cd9238f7ff24","sourcePort":"out-ROLTotale","targetId":"da639c04-8231-64ae-f68f-caf287c7b0dd","targetPort":"margineLordo"},{"sourceId":"da639c04-8231-64ae-f68f-caf287c7b0dd","sourcePort":"result","targetId":"5a46de0c-2b23-2580-75ce-6236159cf209","targetPort":"text"},{"sourceId":"ad66c586-469a-0590-18a7-cd9238f7ff24","sourcePort":"out-ROLTotale","targetId":"ccec207b-dedd-cc82-6461-d1293e4e2244","targetPort":"rol"},{"sourceId":"ad66c586-469a-0590-18a7-cd9238f7ff24","sourcePort":"out-FatturatoTotale","targetId":"ccec207b-dedd-cc82-6461-d1293e4e2244","targetPort":"fatturato"},{"sourceId":"ccec207b-dedd-cc82-6461-d1293e4e2244","sourcePort":"result","targetId":"7b1432f0-2c74-7b02-66f9-f85162e36fe2","targetPort":"text"},{"sourceId":"01ab2a05-84fd-2c67-3e24-56f9b00cfb08","sourcePort":"didMount","targetId":"55ba86d8-53c8-0aac-d7b3-ea5c384f483a","targetPort":"run"},{"sourceId":"01ab2a05-84fd-2c67-3e24-56f9b00cfb08","sourcePort":"didMount","targetId":"e3ca5b93-7491-2e19-774f-30d51e62026c","targetPort":"run"},{"sourceId":"01ab2a05-84fd-2c67-3e24-56f9b00cfb08","sourcePort":"didMount","targetId":"b4aa6479-2595-d0fe-3ba9-a04a304c8b61","targetPort":"run"},{"sourceId":"01ab2a05-84fd-2c67-3e24-56f9b00cfb08","sourcePort":"didMount","targetId":"12f538e9-6715-b847-132a-ec318273ff63","targetPort":"run"},{"sourceId":"01ab2a05-84fd-2c67-3e24-56f9b00cfb08","sourcePort":"didMount","targetId":"84849c05-db2b-5541-5090-648bd707b578","targetPort":"Run"},{"sourceId":"01ab2a05-84fd-2c67-3e24-56f9b00cfb08","sourcePort":"didMount","targetId":"bcc916d7-1ddc-30e7-2e49-15754cfe0069","targetPort":"Run"},{"sourceId":"860f3e2c-0824-656e-bc4f-196b03b35686","sourcePort":"checked","targetId":"ad66c586-469a-0590-18a7-cd9238f7ff24","targetPort":"in-IsGiornaliero"},{"sourceId":"860f3e2c-0824-656e-bc4f-196b03b35686","sourcePort":"onChange","targetId":"ad66c586-469a-0590-18a7-cd9238f7ff24","targetPort":"run"}],"ports":[{"name":"Run","type":{"name":"signal","allowConnectionsOnly":true},"group":"Actions","plug":"input","index":1}],"roots":["01ab2a05-84fd-2c67-3e24-56f9b00cfb08"]},{"name":"/Cards/Card_Ricavi","nodes":[{"id":"cd392d91-e1bc-bb72-5aca-6fbc6d3da558","type":"Group","parameters":{"sizeMode":"contentHeight","marginBottom":{"value":16,"unit":"px"},"marginLeft":{"value":16,"unit":"px"},"marginRight":{"value":16,"unit":"px"},"backgroundColor":"#FFFFFF","borderRadius":{"value":4,"unit":"px"},"paddingTop":{"value":0,"unit":"px"},"paddingRight":{"value":0,"unit":"px"},"paddingBottom":{"value":0,"unit":"px"},"paddingLeft":{"value":0,"unit":"px"},"boxShadowEnabled":true,"boxShadowOffsetX":{"value":3,"unit":"px"},"boxShadowOffsetY":{"value":3,"unit":"px"}},"ports":[],"children":[{"id":"79e4e969-e2e3-0094-3e44-5afc1cff3cb7","type":"Group","parameters":{"sizeMode":"contentHeight","backgroundColor":"blue","paddingLeft":{"value":5,"unit":"px"},"borderTopLeftRadius":{"value":4,"unit":"px"},"borderTopRightRadius":{"value":4,"unit":"px"}},"ports":[],"children":[{"id":"2a4acc79-8c52-a4cc-6c5d-d2f21d35c11e","type":"Text","parameters":{"sizeMode":"contentHeight","width":{"value":100,"unit":"%"},"fontSize":{"value":20,"unit":"px"},"color":"White"},"ports":[],"children":[]}]},{"id":"e2690bbd-caac-d5e3-68bf-d73aa6343ff3","type":"Group","parameters":{"flexDirection":"row","sizeMode":"contentHeight","backgroundColor":"transparent","paddingLeft":{"value":5,"unit":"px"},"paddingTop":{"value":5,"unit":"px"},"paddingRight":{"value":5,"unit":"px"},"paddingBottom":{"value":5,"unit":"px"},"columnGap":{"value":5,"unit":"px"}},"ports":[],"children":[{"id":"2504deb7-d6bc-38fd-520c-4dd2cfa5b777","type":"Text","parameters":{"sizeMode":"contentHeight","width":{"value":25,"unit":"%"},"textStyle":"Body Large"},"ports":[],"children":[]},{"id":"7184fce2-6098-d30d-ef07-0a123956a818","type":"Text","parameters":{"sizeMode":"contentHeight","width":{"value":25,"unit":"%"},"textStyle":"Body Large"},"ports":[],"children":[]},{"id":"999a618f-7d69-3efe-8f81-507a26e2e14f","type":"Text","parameters":{"width":{"value":25,"unit":"%"},"fontFamily":"fonts/Roboto/Roboto-LightItalic.ttf"},"ports":[],"children":[]},{"id":"3e4d93c5-9690-238a-84db-93c3a72370c3","type":"Text","parameters":{"width":{"value":25,"unit":"%"},"fontFamily":"fonts/Roboto/Roboto-LightItalic.ttf"},"ports":[],"children":[]}]},{"id":"476377f5-e808-d8cb-12c9-75cf50082546","type":"Group","parameters":{"flexDirection":"row","paddingLeft":{"value":5,"unit":"px"},"paddingTop":{"value":5,"unit":"px"},"paddingRight":{"value":5,"unit":"px"},"paddingBottom":{"value":5,"unit":"px"}},"ports":[],"children":[{"id":"46d90862-6141-6735-df6d-e10d062f6633","type":"Text","parameters":{"width":{"value":50,"unit":"%"},"textStyle":"Body Medium","fontFamily":"fonts/Roboto/Roboto-Bold.ttf"},"ports":[],"children":[]},{"id":"9989c4a1-4bbe-05d5-6a1a-f7614ade8bbc","type":"Text","parameters":{"width":{"value":50,"unit":"%"}},"ports":[],"children":[]}]}]},{"id":"a6fc808f-93ca-b7fc-929e-9a9896315e40","type":"Component Inputs","parameters":{},"ports":[],"children":[]},{"id":"852aa135-0046-1166-75ce-402d21fee8f5","type":"Expression","parameters":{"expression":"\"€ \" + importo"},"ports":[],"children":[]}],"connections":[{"sourceId":"a6fc808f-93ca-b7fc-929e-9a9896315e40","sourcePort":"date","targetId":"2504deb7-d6bc-38fd-520c-4dd2cfa5b777","targetPort":"text"},{"sourceId":"a6fc808f-93ca-b7fc-929e-9a9896315e40","sourcePort":"soggetto","targetId":"2a4acc79-8c52-a4cc-6c5d-d2f21d35c11e","targetPort":"text"},{"sourceId":"a6fc808f-93ca-b7fc-929e-9a9896315e40","sourcePort":"area","targetId":"999a618f-7d69-3efe-8f81-507a26e2e14f","targetPort":"text"},{"sourceId":"a6fc808f-93ca-b7fc-929e-9a9896315e40","sourcePort":"ticket","targetId":"3e4d93c5-9690-238a-84db-93c3a72370c3","targetPort":"text"},{"sourceId":"a6fc808f-93ca-b7fc-929e-9a9896315e40","sourcePort":"gestore","targetId":"46d90862-6141-6735-df6d-e10d062f6633","targetPort":"text"},{"sourceId":"a6fc808f-93ca-b7fc-929e-9a9896315e40","sourcePort":"prodotto","targetId":"9989c4a1-4bbe-05d5-6a1a-f7614ade8bbc","targetPort":"text"},{"sourceId":"a6fc808f-93ca-b7fc-929e-9a9896315e40","sourcePort":"importo","targetId":"852aa135-0046-1166-75ce-402d21fee8f5","targetPort":"importo"},{"sourceId":"852aa135-0046-1166-75ce-402d21fee8f5","sourcePort":"result","targetId":"7184fce2-6098-d30d-ef07-0a123956a818","targetPort":"text"}],"ports":[{"name":"date","type":{"name":"string","multiline":true},"default":"Text","group":"Text","plug":"input","index":1},{"name":"importo","type":{"name":"*","editAsType":"string"},"group":"Parameters","plug":"input","index":2},{"name":"soggetto","type":{"name":"string","multiline":true},"default":"Text","group":"Text","plug":"input","index":3},{"name":"area","type":{"name":"string","multiline":true},"default":"Text","group":"Text","plug":"input","index":4},{"name":"ticket","type":{"name":"string","multiline":true},"default":"Text","group":"Text","plug":"input","index":5},{"name":"gestore","type":{"name":"string","multiline":true},"default":"Text","group":"Text","plug":"input","index":6},{"name":"prodotto","type":{"name":"string","multiline":true},"default":"Text","group":"Text","plug":"input","index":7},{"name":"ticketvalue","type":"*","plug":"input","index":9}],"roots":["cd392d91-e1bc-bb72-5aca-6fbc6d3da558"]},{"name":"/Cards/Card_Costi","nodes":[{"id":"24d3c13f-ab38-9369-d4e8-f9024137822e","type":"Group","parameters":{"sizeMode":"contentHeight","marginBottom":{"value":16,"unit":"px"},"marginLeft":{"value":16,"unit":"px"},"marginRight":{"value":16,"unit":"px"},"backgroundColor":"#FFFFFF","borderRadius":{"value":4,"unit":"px"},"paddingTop":{"value":0,"unit":"px"},"paddingRight":{"value":0,"unit":"px"},"paddingBottom":{"value":0,"unit":"px"},"paddingLeft":{"value":0,"unit":"px"},"boxShadowEnabled":true,"boxShadowOffsetX":{"value":3,"unit":"px"},"boxShadowOffsetY":{"value":3,"unit":"px"}},"ports":[],"children":[{"id":"49a04760-9435-1a4b-86a6-f827148071ca","type":"Group","parameters":{"sizeMode":"contentHeight","backgroundColor":"red","paddingLeft":{"value":5,"unit":"px"},"borderTopLeftRadius":{"value":4,"unit":"px"},"borderTopRightRadius":{"value":4,"unit":"px"},"paddingTop":{"value":0,"unit":"px"},"marginRight":{"value":0,"unit":"px"},"marginBottom":{"value":0,"unit":"px"},"paddingRight":{"value":5,"unit":"px"},"paddingBottom":{"value":0,"unit":"px"}},"ports":[],"children":[{"id":"407f37b4-98ef-a379-c42b-efc3047f8764","type":"Text","parameters":{"sizeMode":"contentHeight","width":{"value":100,"unit":"%"},"color":"White","fontSize":{"value":20,"unit":"px"}},"ports":[],"children":[]}]},{"id":"fe35d8f1-32ba-81fd-0d5f-6ee0e70547ea","type":"Group","parameters":{"flexDirection":"row","sizeMode":"contentHeight","backgroundColor":"transparent","paddingLeft":{"value":5,"unit":"px"},"paddingTop":{"value":5,"unit":"px"},"paddingRight":{"value":5,"unit":"px"},"paddingBottom":{"value":5,"unit":"px"},"columnGap":{"value":5,"unit":"px"}},"ports":[],"children":[{"id":"d8a0be1b-9580-fee1-2449-ae11096783db","type":"Text","parameters":{"sizeMode":"contentHeight","width":{"value":25,"unit":"%"},"textStyle":"Body Large","textAlignX":"left","textAlignY":"center"},"ports":[],"children":[]},{"id":"58449b94-e721-f4dd-8810-0ee51fdaa07b","type":"Text","parameters":{"sizeMode":"contentHeight","width":{"value":25,"unit":"%"},"textAlignY":"center","textStyle":"Body Large"},"ports":[],"children":[]},{"id":"6cd67404-1564-42fa-3ffa-d28e173ef929","type":"Text","parameters":{"width":{"value":25,"unit":"%"},"textAlignY":"center","textStyle":"Body Medium","fontFamily":"fonts/Roboto/Roboto-LightItalic.ttf"},"ports":[],"children":[]},{"id":"2de2fdeb-940c-a072-9268-c39752fe2a81","type":"Text","parameters":{"width":{"value":25,"unit":"%"},"textAlignY":"center","fontFamily":"fonts/Roboto/Roboto-LightItalic.ttf"},"ports":[],"children":[]}]},{"id":"1b649e87-2c2a-6047-efb7-0fc84c50d8d9","type":"Group","parameters":{},"ports":[],"children":[{"id":"01f65361-85d2-30d6-cef7-31e4c8d72c44","type":"Text","parameters":{"text":""},"ports":[],"children":[]}]}]},{"id":"96e058e4-5f6b-6ffb-b9a4-41b7d2699610","type":"Component Inputs","parameters":{},"ports":[],"children":[]},{"id":"8fef2d4f-692a-79b4-8733-252b338d620d","type":"Expression","parameters":{"expression":"\"€ \" + importo"},"ports":[],"children":[]},{"id":"d4a94ef4-079f-f0ab-e222-c5cac24851b9","type":"JavaScriptFunction","parameters":{"functionScript":"const inDescr = Inputs.Descrizione;\n\nconst outDescr = (inDescr === null ? \"\" : inDescr);\n\nOutputs.Descrizione = outDescr;"},"ports":[{"name":"in-Descrizione","displayName":"Descrizione","plug":"input","type":"*","group":"Inputs","index":4},{"name":"out-Descrizione","displayName":"Descrizione","plug":"output","type":"*","group":"Outputs","index":5}],"children":[]}],"connections":[{"sourceId":"96e058e4-5f6b-6ffb-b9a4-41b7d2699610","sourcePort":"date","targetId":"d8a0be1b-9580-fee1-2449-ae11096783db","targetPort":"text"},{"sourceId":"96e058e4-5f6b-6ffb-b9a4-41b7d2699610","sourcePort":"soggetto_ragsoc","targetId":"407f37b4-98ef-a379-c42b-efc3047f8764","targetPort":"text"},{"sourceId":"96e058e4-5f6b-6ffb-b9a4-41b7d2699610","sourcePort":"an_area_nome","targetId":"6cd67404-1564-42fa-3ffa-d28e173ef929","targetPort":"text"},{"sourceId":"96e058e4-5f6b-6ffb-b9a4-41b7d2699610","sourcePort":"an_tecnologia_nome","targetId":"2de2fdeb-940c-a072-9268-c39752fe2a81","targetPort":"text"},{"sourceId":"96e058e4-5f6b-6ffb-b9a4-41b7d2699610","sourcePort":"importo","targetId":"8fef2d4f-692a-79b4-8733-252b338d620d","targetPort":"importo"},{"sourceId":"8fef2d4f-692a-79b4-8733-252b338d620d","sourcePort":"result","targetId":"58449b94-e721-f4dd-8810-0ee51fdaa07b","targetPort":"text"},{"sourceId":"96e058e4-5f6b-6ffb-b9a4-41b7d2699610","sourcePort":"descrizione","targetId":"d4a94ef4-079f-f0ab-e222-c5cac24851b9","targetPort":"in-Descrizione"},{"sourceId":"d4a94ef4-079f-f0ab-e222-c5cac24851b9","sourcePort":"out-Descrizione","targetId":"01f65361-85d2-30d6-cef7-31e4c8d72c44","targetPort":"text"}],"ports":[{"name":"date","type":{"name":"string","multiline":true},"default":"Text","group":"Text","plug":"input","index":0},{"name":"importo","type":{"name":"*","editAsType":"string"},"group":"Parameters","plug":"input","index":2},{"name":"soggetto_ragsoc","type":{"name":"string","multiline":true},"default":"Text","group":"Text","plug":"input","index":3},{"name":"an_area_nome","type":{"name":"string","multiline":true},"default":"Text","group":"Text","plug":"input","index":4},{"name":"an_tecnologia_nome","type":{"name":"string","multiline":true},"default":"Text","group":"Text","plug":"input","index":5},{"name":"descrizione","type":"*","group":"Inputs","plug":"input","index":6}],"roots":["24d3c13f-ab38-9369-d4e8-f9024137822e"]},{"name":"/Query/Select/Select_costi_detail_incassato","nodes":[{"id":"9ea4810a-ab51-1c41-e3e2-878f0890de05","type":"JavaScriptFunction","parameters":{"functionScript":"const supabase = Noodl.Variables.supabase;\n\nif (!supabase) throw new Error('Supabase client not found');\n\n  try {\n    // Definizione delle variabili per i filtri e l'ordinamento\n    const var_when_soggetto = Inputs.Var_when_soggetto; // Sostituisci con il valore desiderato o lascia vuoto\n    const var_when_area = Inputs.Var_when_area; // Sostituisci con il valore desiderato o lascia vuoto\n    const var_when_ticket = Inputs.Var_when_ticket; // Sostituisci con il valore desiderato o lascia vuoto\n    const var_orderby_column = Inputs.Var_orderby_column; // Sostituisci con il nome della colonna per l'ordinamento o lascia vuoto\n    const var_orderby_desc_asc = Inputs.Var_orderby_desc_asc; // Usa 'asc' per ascendente, 'desc' per discendente, o lascia vuoto\n    const dataDal = Inputs.DataDal;\n    const dataAl = Inputs.DataAl;\n    // Inizia a costruire la query\n    let query = supabase.from('v_costi_detail')\n    .select('supid:id, date, importo, an_area, an_area_nome, an_tecnologia, an_tecnologia_nome, soggetto, soggetto_ragsoc, descrizione');\n    // Applica la clausola where condizionalmente\n        let matchConditions = { payment_done: true }; // Filtro per visualizzare solo l'incassato\n        if (var_when_area) matchConditions.an_area = var_when_area;\n        if (var_when_ticket) matchConditions.an_tecnologia = var_when_ticket;\n        if (var_when_soggetto) matchConditions.soggetto = var_when_soggetto;\n        query = query.match(matchConditions);\n      // Applica la clausola order by condizionalmente\n      if (var_orderby_column && var_orderby_desc_asc) {\n        query = query.order(var_orderby_column, { ascending: var_orderby_desc_asc === 'asc' });\n      }\n\n      // Applica un order by per il mese estratto dalla colonna 'date'\n      query = query.order('date', { ascending: true });\n\n      //Applica i filtri date Dal Al condizionalmente\n      if (dataDal) {\n            // Filtra gli eventi a partire da questa data (inclusa)\n            query = query.gte('date', dataDal);\n        }\n      if (dataAl) {\n            // Filtra gli eventi fino a questa data (inclusa)\n            query = query.lte('date', dataAl);\n      }\n    // Esegue la query\n    const { data, error } = await query;\n\n  // Ricorda di gestire sia `data` che `error`\n\n    if (error) {\n      console.error(error)\n      Outputs.Failure();\n      console.log(\"errore\");\n    } else if (data) {\n      Outputs.DataCosti = data;\n      Outputs.TotaliCosti = data.reduce((acc, curr) => acc + curr.importo, 0);\n      Outputs.Success();\n    }\n    else {\n      console.log(\"non eseguita\");\n    }\n} catch (error) {\n    console.error(\"errore :\" + error)\n    Outputs.Failure();\n}\n","scriptOutputs":[],"outtype-Success":"signal"},"ports":[{"name":"in-Var_when_soggetto","displayName":"Var_when_soggetto","plug":"input","type":"*","group":"Inputs","index":4},{"name":"in-Var_when_area","displayName":"Var_when_area","plug":"input","type":"*","group":"Inputs","index":5},{"name":"in-Var_when_ticket","displayName":"Var_when_ticket","plug":"input","type":"*","group":"Inputs","index":6},{"name":"in-Var_orderby_column","displayName":"Var_orderby_column","plug":"input","type":"*","group":"Inputs","index":7},{"name":"in-Var_orderby_desc_asc","displayName":"Var_orderby_desc_asc","plug":"input","type":"*","group":"Inputs","index":8},{"name":"in-DataDal","displayName":"DataDal","plug":"input","type":"*","group":"Inputs","index":9},{"name":"in-DataAl","displayName":"DataAl","plug":"input","type":"*","group":"Inputs","index":10},{"name":"out-Failure","displayName":"Failure","plug":"output","type":"signal","group":"Outputs","index":11},{"name":"out-Success","displayName":"Success","plug":"output","type":"signal","group":"Outputs","index":12},{"name":"out-DataCosti","displayName":"DataCosti","plug":"output","type":"*","group":"Outputs","index":13},{"name":"out-TotaliCosti","displayName":"TotaliCosti","plug":"output","type":"*","group":"Outputs","index":14}],"children":[]},{"id":"45b9b370-2ce4-e793-e2be-1897b2d8033f","type":"Component Inputs","parameters":{},"ports":[],"children":[]},{"id":"f5443807-f7ee-8d2d-1931-72b96a7be6c3","type":"Component Outputs","parameters":{},"ports":[],"children":[]},{"id":"b20e014f-3858-c7c6-54ca-3e29491becdf","type":"Date To String","parameters":{},"ports":[],"children":[]},{"id":"879c7d8c-321c-b6fb-edff-d099354c8cc7","type":"Date To String","parameters":{},"ports":[],"children":[]}],"connections":[{"sourceId":"45b9b370-2ce4-e793-e2be-1897b2d8033f","sourcePort":"Run","targetId":"9ea4810a-ab51-1c41-e3e2-878f0890de05","targetPort":"run"},{"sourceId":"45b9b370-2ce4-e793-e2be-1897b2d8033f","sourcePort":"var_when_soggetto","targetId":"9ea4810a-ab51-1c41-e3e2-878f0890de05","targetPort":"in-Var_when_soggetto"},{"sourceId":"45b9b370-2ce4-e793-e2be-1897b2d8033f","sourcePort":"var_when_area","targetId":"9ea4810a-ab51-1c41-e3e2-878f0890de05","targetPort":"in-Var_when_area"},{"sourceId":"45b9b370-2ce4-e793-e2be-1897b2d8033f","sourcePort":"var_when_ticket","targetId":"9ea4810a-ab51-1c41-e3e2-878f0890de05","targetPort":"in-Var_when_ticket"},{"sourceId":"45b9b370-2ce4-e793-e2be-1897b2d8033f","sourcePort":"var_orderby_column","targetId":"9ea4810a-ab51-1c41-e3e2-878f0890de05","targetPort":"in-Var_orderby_column"},{"sourceId":"45b9b370-2ce4-e793-e2be-1897b2d8033f","sourcePort":"var_orderby_desc_asc","targetId":"9ea4810a-ab51-1c41-e3e2-878f0890de05","targetPort":"in-Var_orderby_desc_asc"},{"sourceId":"45b9b370-2ce4-e793-e2be-1897b2d8033f","sourcePort":"dataDal","targetId":"b20e014f-3858-c7c6-54ca-3e29491becdf","targetPort":"input"},{"sourceId":"45b9b370-2ce4-e793-e2be-1897b2d8033f","sourcePort":"dataAl","targetId":"879c7d8c-321c-b6fb-edff-d099354c8cc7","targetPort":"input"},{"sourceId":"b20e014f-3858-c7c6-54ca-3e29491becdf","sourcePort":"currentValue","targetId":"9ea4810a-ab51-1c41-e3e2-878f0890de05","targetPort":"in-DataDal"},{"sourceId":"879c7d8c-321c-b6fb-edff-d099354c8cc7","sourcePort":"currentValue","targetId":"9ea4810a-ab51-1c41-e3e2-878f0890de05","targetPort":"in-DataAl"},{"sourceId":"9ea4810a-ab51-1c41-e3e2-878f0890de05","sourcePort":"out-TotaliCosti","targetId":"f5443807-f7ee-8d2d-1931-72b96a7be6c3","targetPort":"totaleCosti"},{"sourceId":"9ea4810a-ab51-1c41-e3e2-878f0890de05","sourcePort":"out-Success","targetId":"f5443807-f7ee-8d2d-1931-72b96a7be6c3","targetPort":"Success"},{"sourceId":"9ea4810a-ab51-1c41-e3e2-878f0890de05","sourcePort":"out-DataCosti","targetId":"f5443807-f7ee-8d2d-1931-72b96a7be6c3","targetPort":"dataCosti"}],"ports":[{"name":"dataCosti","type":"*","plug":"output","index":1},{"name":"Run","type":{"name":"signal","allowConnectionsOnly":true},"group":"Actions","plug":"input","index":1},{"name":"Success","type":"signal","plug":"output","index":2},{"name":"var_when_soggetto","type":"*","group":"Inputs","plug":"input","index":2},{"name":"totaleCosti","type":"*","plug":"output","index":3},{"name":"var_when_area","type":"*","group":"Inputs","plug":"input","index":3},{"name":"costiArrayID","type":"*","plug":"output","index":4},{"name":"var_when_ticket","type":"*","group":"Inputs","plug":"input","index":4},{"name":"var_orderby_column","type":"*","group":"Inputs","plug":"input","index":5},{"name":"var_orderby_desc_asc","type":"*","group":"Inputs","plug":"input","index":6},{"name":"dataDal","type":{"name":"date"},"plug":"input","index":7},{"name":"dataAl","type":{"name":"date"},"plug":"input","index":8}],"roots":[]}]